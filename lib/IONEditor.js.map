{"version":3,"sources":["../src/IONEditor.js"],"names":["insertTextAtCursor","el","text","val","value","endIndex","range","doc","ownerDocument","selectionStart","selectionEnd","slice","length","selection","createRange","focus","collapse","select","IONEditor","container","textStyle","textCodeStyle","edit","document","createElement","setAttribute","prop","style","appendChild","preStyle","codeStyle","pre","disp","init","lineLength","window","addEventListener","e","key","preventDefault","split","ctrlKey","shiftKey","JSONText","JSONobj","JSON","parse","finalText","target","dispatchEvent","CustomEvent","bubbles","detail","bind","console","log","height","scrollHeight","content","innerHTML","innerText","highlight"],"mappings":"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","file":"IONEditor.js","sourcesContent":["import {fromJSONObject, toJSONText, highlightION} from \"ion2\";\n\nfunction insertTextAtCursor(el, text) {\n    var val = el.value, endIndex, range, doc = el.ownerDocument;\n    if (typeof el.selectionStart == \"number\"\n            && typeof el.selectionEnd == \"number\") {\n        endIndex = el.selectionEnd;\n        el.value = val.slice(0, endIndex) + text + val.slice(endIndex);\n        el.selectionStart = el.selectionEnd = endIndex + text.length;\n    } else if (doc.selection != \"undefined\" && doc.selection.createRange) {\n        el.focus();\n        range = doc.selection.createRange();\n        range.collapse(false);\n        range.text = text;\n        range.select();\n    }\n}\n\nexport default class IONEditor{\n\n    constructor(container){\n\n        this.textStyle = {\n            \"background\": \"transparent\",\n            \"z-index\": 2,\n            \"height\": \"auto\",\n            \"resize\": \"none\",\n            \"-webkit-text-fill-color\": \"transparent\",\n            \"outline\" : \"none\"\n        };\n\n        this.textCodeStyle = {\n            \"position\": \"absolute\",\n            \"top\": '0px',\n            \"left\": 0,\n            \"width\": '550px',\n            \"font-family\" : '\"Inconsolata\", \"TheSansMono Office\", \"FiraSans Mono, monospace\"',\n            \"font-size\":\"12px\",\n            \"letter-spacing\": \"-0.05em\",\n            \"line-height\": \"150%\",\n            \"padding\":\"10px\",\n            \"resize\": \"none\",\n            \"border\" : \"none\",\n            \"border-radius\": \"5px\",\n            \"overflow-x\": \"scroll\",\n            \"overflow-y\": \"scroll\"\n        }\n\n        this.edit = document.createElement('textarea');\n        this.edit.setAttribute(\"id\", \"textedit\");\n        this.edit.setAttribute(\"spellcheck\", \"false\");\n        this.edit.setAttribute('class', 'editor');\n    \n        for (let prop in this.textStyle) this.edit.style[prop] = this.textStyle[prop];\n        for (let prop in this.textCodeStyle) this.edit.style[prop] = this.textCodeStyle[prop];\n\n        container.appendChild(this.edit);\n\n        this.preStyle = {\n            \"white-space\": \"pre-wrap\",\n            \"word-wrap\": \"break-word\"\n        }\n        \n        this.codeStyle = {\n            \"background\": \"#fdf6e3\",\n            \"z-index\": 1\n        }\n        \n\n        let pre   = document.createElement('pre');\n        this.disp = document.createElement('code');\n        this.disp.setAttribute(\"id\", \"textdisp\");\n        this.disp.setAttribute('class', 'editor editor-display');\n        pre.appendChild(this.disp);\n        container.appendChild(pre);\n\n        for (let prop in this.preStyle) pre.style[prop] = this.preStyle[prop];\n        for (let prop in this.textCodeStyle) this.disp.style[prop] = this.textCodeStyle[prop];\n        for (let prop in this.codeStyle) this.disp.style[prop] = this.codeStyle[prop];\n\n\n        this.init();\n    }\n\n    init(){\n\n        let lineLength = 120;\n\n        window.addEventListener(\"keydown\", function(e){\n\n            if (e.key === \"Tab\"){\n                e.preventDefault();\n                this.edit.value.split(\"\\n\")\n                insertTextAtCursor(this.edit, \"  \");\n\n            }if(e.key===\"Enter\" && e.ctrlKey && e.shiftKey){\n                let JSONText  = toJSONText(this.edit.value),\n                    JSONobj   = JSON.parse(JSONText),\n                    finalText = fromJSONObject(JSONobj, lineLength);\n                this.edit.value = finalText;\n                this.edit.focus();\n\n                e.target.dispatchEvent(new CustomEvent('interpret', { bubbles: true, detail: JSONobj }));\n\n            } else if(e.key===\"Enter\" && e.ctrlKey){\n                // this.strokeBase.submit(this.input.value);\n            }\n        \n        }.bind(this));\n\n        this.edit.addEventListener(\"input\", function(e){\n\n            console.log(\"yaya\");\n            this.edit.style.height = this.edit.scrollHeight;\n            var  content = this.edit.value;\n            this.disp.innerHTML = highlightION(content, \"\", \"color:#d33682;\")+\"\\n \";\n    \n        }.bind(this));\n\n        this.edit.innerText = \"@ \";\n        this.disp.innerHTML = highlightION(\"@ \", \"\", \"color:#d33682;\")+\"\\n \";\n        this.edit.focus();\n    }\n\n    highlight(){\n\n    }\n\n    update(text){\n        this.edit.value = text;\n        this.highlight();\n    }\n}\n"]}