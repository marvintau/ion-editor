{"version":3,"sources":["../src/ION.js"],"names":["fromJSONObject","toJSONText","highlightION","indentWidth","lineLength","quoteString","str","match","arrayWarpedPrefix","e","i","objectWarpedPrefix","objectWarpedKey","key","quotedKey","repeat","length","objectWarpedKeyNext","returnedArray","concat","map","handleArray","object","recurFunc","remLen","res","flat","joined","join","notAtomic","some","includes","warpCond","handleObject","keys","Object","resSameLine","k","val","warpSamelineCond","warpedSameLine","v","warpNextLineCond","resNextLine","warpedNextLine","fromJSONObjectRecursive","toString","toFixed","Array","isArray","returnRightBracket","stack","pairs","type","text","lines","split","filter","resultText","currIndent","lineIndent","search","indent","pop","currLineRem","comma","trim","push","slice","quoted","simple","result","parsed","parseFloat","t","replace","test","cases","a","b","c","n1","n2","n3","console","log","x","fromJSON"],"mappings":"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","file":"ION.js","sourcesContent":["var indentWidth = 4,\n    lineLength  = 120;\n\n\n/**\n * determine whether a string should be quoted.\n * @param {string} str input string\n */\nfunction quoteString(str){\n    return str.match(/[ @]/) ? '\"' + str + '\"' : str;\n}\n\n/**\n * insert prefix before warped array\n * @param {string} e element\n * @param {number} i index\n */\nfunction arrayWarpedPrefix(e, i){\n    return (i == 0 ? \"@ \" : \"  \") + e;\n}\n\n/**\n * insert prefix before warped object\n * @param {string} e element\n * @param {number} i element index\n */\nfunction objectWarpedPrefix(e, i){\n    return (i == 0 ? \"# \" : \"  \") + e;\n}\n\n/**\n * warp a series of object in a key-value pair, aligning to the key\n * @param {string} e element\n * @param {number} i index\n * @param {stirng} key the key followed by\n */\nfunction objectWarpedKey(e, i, key){\n    var quotedKey = quoteString(key);\n    return (i == 0 ? quotedKey + \": \" : \" \".repeat(quotedKey.length+2)) + e;\n}\n\n/**\n * warp to next line after key in order to save more space.\n * @param {string} returnedArray array of element returned from next level\n * @param {*} key the key of current key-value pair\n */\nfunction objectWarpedKeyNext(returnedArray, key){\n    return [key+\":\"].concat(returnedArray.map( e=> \" \" + e));\n}\n\n/**\n * process if an array of next level is identified.\n * @param {object} object sub-level of object.\n * @param {function} recurFunc the call-back recursive function.\n * @param {number} remLen remaining length of current line\n */\nfunction handleArray(object, recurFunc, remLen){\n    var res       = object.map((e) => recurFunc(e, remLen - 2)).flat(),\n        joined    = res.join(' '),\n        notAtomic = res.some(e => e.includes(\"@\") || e.includes(\"#\")),\n        warpCond  = ( notAtomic || joined.length > remLen);\n        \n    return (warpCond) ? res.map(arrayWarpedPrefix) : [\"@ \" + joined];\n}\n\n/**\n * \n * @param {object} object object to be handled\n * @param {function} recurFunc \n * @param {*} remLen \n */\nfunction handleObject(object, recurFunc, remLen){\n\n    //  First we get all keys of the object in current level. Note that all keys' value\n    //  has been done by recurFunc. the resSameLine is an array of key-value pairs.\n    //  if there is no # or @, then it must be either string or number, which we call it\n    //  atomic.\n    \n    //  If an element is not atomic, then it must be warped.\n\n    let keys           = Object.keys(object),\n        resSameLine    = keys.map((k) => ({key:k, val:recurFunc(object[k], remLen - k.length)})),\n        notAtomic      = resSameLine.map(e => e.val.some(e => e.includes(\"@\") || e.includes(\"#\"))).some(e=>e);\n        \n    let joined           = resSameLine.map((e) => quoteString(e.key) + \": \" + e.val[0]).join(\" \"),\n        warpSamelineCond = ( notAtomic || joined.length > remLen),\n        warpedSameLine   = resSameLine.map((e) => e.val.map((v, i) => objectWarpedKey(v, i, e.key))).flat(),\n\n        warpNextLineCond = warpedSameLine.some(e => e.length > lineLength),\n        resNextLine = keys.map((k) => ({key:k, val:recurFunc(object[k], remLen - 2)})),\n        warpedNextLine   = resNextLine.map((e) => objectWarpedKeyNext(e.val, e.key)).flat();\n        \n    return (warpNextLineCond) ? warpedNextLine.map(objectWarpedPrefix) :\n           (warpSamelineCond) ? warpedSameLine.map(objectWarpedPrefix) : [\"# \" + joined];\n}\n\n/**\n * fromJSONObject\n * \n * @param {object} object object to be interpreted\n * @param {number} currCursor the current place of interpreted string\n * @param {number} nextLineCursor the position where the warped line starts\n * \n * @returns {object} an array of string\n */\nfunction fromJSONObjectRecursive(object, remLen){\n\n    switch(typeof object){\n        case \"string\":\n            return [quoteString(object)];\n        case \"number\":\n\n            return [ object % 1 == 0 ? object.toString() : object.toFixed(3)];\n        case \"object\":\n            var res = (Array.isArray(object)) \n                      ? handleArray(object, fromJSONObjectRecursive, remLen)\n                      : handleObject(object, fromJSONObjectRecursive, remLen);\n            \n            return res;\n    }\n}\n\nexport function fromJSONObject(object){\n    return fromJSONObjectRecursive(object, lineLength).join(\"\\n\");\n}\n\n\nfunction returnRightBracket(stack){\n    var pairs = {\"{\": \"}\", \"[\": \"]\", \":\":\"\"};\n    return pairs[stack[stack.length - 1].type];\n}\n\n//  The only thing that really matter is the end of indentation.\n//  so this function will scan the text line by line, word by word.\n//  when meet @, push stack with [, and # with { . when encounter\n//  the \", find the next \" and append to text with string, or anything \n//  end with space or comma.\n\n//  对于向JSON的转换，由于头部的@, [, #等都给出清晰的提示，因此重要的是判断\n//  结束缩进时是从哪一层退出。\nexport function toJSONText(text){\n    \n    var lines = text.split(\"\\n\").filter(e => !e.match(/^\\s*$/));\n    \n    var resultText = \"\",\n        stack      = [],\n        currIndent = 0;\n\n    for (let i = 0; i < lines.length; i++){\n\n        var lineIndent = lines[i].search(/\\S|$/);\n        while (stack.length > 0 && stack[stack.length - 1].indent >= lineIndent){\n            resultText += returnRightBracket(stack);\n            stack.pop();\n        }\n\n        currIndent = 0;\n        var currLineRem = lines[i];\n        \n        while(currLineRem.length > 0){\n            switch(currLineRem[0]){\n                case \" \":\n                    // a space, might be a delimiter (comma)\n                    \n                    if (stack[stack.length - 1].comma)\n                        resultText += \", \";\n                    else\n                        stack[stack.length - 1].comma = true;\n\n                    currIndent  += currLineRem.search(/\\S|$/);\n                    currLineRem  = currLineRem.trim();\n                    break;\n\n                case \"@\": \n                    // beginning of an arary\n                    resultText += \"[\"; stack.push({type:\"[\", indent: currIndent, comma:false});\n                    currIndent += 1;\n                    currLineRem = currLineRem.slice(1);\n                    break;\n\n                case \"#\":\n                    // beginning of an object\n                    resultText += \"{\"; stack.push({type:\"{\", indent: currIndent, comma:false});\n                    currIndent += 1;\n                    currLineRem = currLineRem.slice(1);\n                    break;\n\n                case \":\":\n                    resultText += \":\"; stack.push({type:\":\", indent: currIndent});\n                    currIndent += 1;\n                    currLineRem = currLineRem.slice(1);\n                    break;\n\n                case '\"':\n                    // beginning of a quoted string. Notably, we don't accept\n                    // a single quotation mark appearing on a single line.\n\n                    var quoted = currLineRem.match(/\"(?:\\\\\"|[^\"])*\"/);\n                    if (!quoted) throw \"Quoted string missing at Line: \" + i;\n                    \n                    if (stack.length > 0 && stack[stack.length - 1].type == \":\") stack.pop();\n                    currIndent += quoted[0].length;\n                    resultText += currLineRem.slice(0, quoted[0].length);\n                    currLineRem = currLineRem.slice(quoted[0].length);\n                    break;\n\n\n                default :\n                    // means we meet a simple string, that a string doesn't\n                    // contains space, and quotation marks on both ends.\n                    // however, it's okay to contain a single quotation mark\n                    // in the middle of the string.\n                    // console.log(\"gotcha\");\n                    var simple = currLineRem.match(/[^\\s:]*/);\n                    if (!simple) throw \"Simple string got some problem at Line: \" + 1;\n                    if (stack.length > 0 && stack[stack.length - 1].type == \":\") {stack.pop();}\n\n                    currIndent += simple[0].length;\n\n                    var result = currLineRem.slice(0, simple[0].length),\n                        parsed = parseFloat(result) ;\n                    \n                    resultText += (!parsed && parsed != 0) ? '\"' + result + '\"' : parsed;\n\n                    currLineRem = currLineRem.slice(simple[0].length);\n                    break;\n\n            }\n        }\n    }\n\n    while (stack.length > 0 && stack[stack.length - 1].indent >= 0){\n        resultText += returnRightBracket(stack);\n        stack.pop();\n    }\n\n    return resultText;\n}\n\nexport function highlightION(text){\n    return text.split('\\n').map(t=> t\n        .replace(/(\\S+\\s*)(?=:)/g, '<b>$1</b>')\n        .replace(/([#@:])/g, '<b style=\"color:#d33682;\">$1</b>'))\n        .join('\\n');\n}\n\nfunction test(){\n    var cases = {\n        \"simpleString\" : \"asd\",\n        \"simpleNumber\" : 3.1415926,\n        \"simpleList\" : [\"a\", \"b\", \"c\"],\n        \"simpleNestedList\" : [\"a\", [\"inner-a\", \"inner-b\"], \"c\"],\n        \"longerNestedList\" : [\"a\", [\n            \"inner-a which contains longer string that can't hold by single line\",\n            \"inner-b which contains longer string that can't hold by single line as well\"], \"c\"],\n        \"tripleNestedList\" : [\"a\", [\"inner-a\", [\"inner-b\"]], \"c\"],\n        \"arrayWithObject\" : [\"a\", [\"inner-a\", {\"inner-b\":\"asd\"}], \"c\"],\n        \"simpleObject\" :{a:1, b:2, c:3},\n        \"nestedObject\" :{a:1, b:{n1:1, n2:2}, c:3},\n        \"tripleNestedObject\" :{a:1, b:{n1:1, n3:{n2:2}}, c:3},\n        \"objectWithArray\" :{a:1, b:{n1:1, n3:[\"inner-a which contains longer string that can't hold by single line\", \"inner-b which contains longer string that can't hold by single line as well\"]}, c:3},\n        // \"objectWithLongLey\": {\"this is really a long key, and wait for a line wrap\":[\"and literally a really really long value to the key\", \"and anothe rvalue\"],\n        //                         \"this is another long key\":\"and literally a long value to the key\"}\n    };\n    \n    for (let i in cases) {\n        console.log(\"\\n\");\n        console.log(\"Case : \", i, \"\\n\");\n        var x = fromJSON(cases[i]);\n        console.log(highlightION(x));\n        // console.log(toJSON(x));\n    }\n}\n\n"]}